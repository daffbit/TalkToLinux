Ինչպես տեղադրել Արչ Լինուքսը
===============

Ողջույն: Սա գրառում է այն մասին, թե ինչպես տեղադրել Արչ Լինուքս բաշխումը համակարգչի/վիրտուալ մեքենայի վրա: 


Առաջին բանը, որ հարկավոր է անել, դա ISO պատկերի բեռնումն է: Բեռնել այն կարող եք [այստեղից](https://www.archlinux.org/download/):

Այնուհետև հարկավոր է գրել պատկերը սկավառակի/USB կրիչի վրա: Եթե գրում եք Windows-ով օգտագործեք *Win32 Disk Imager* գործիքը, եթե լինուքսից՝ *dd* հրամանը: Վիրտուալ մեքենայի վրա տեղադրելու համար հարկավոր է ուղակի միացնել ISO պատկերը որպես սկավառակ: 

Եթե դուք արդեն ունեք տեղադրած Արչ Լինուքս, ապա նոր տարբերակի պատկեր բեռնելու կարիք չկա, բավական է տերմինալում հավաքել.
```bash
$ sudo pacman -Syu
``` 

Երբ պատկերը բեռնվի, դու կտեսնեք մենյու, որում կլինի ընտրության մի քանի հնարավորություն: Տեղադրման համար պետք է ընտրել առաջին երկուսից որևէ մեկը: Կամ x86_64՝ 64-բիթային մեքենաների համար, կամ i586՝ համապատասխանաբար ~~i586~~-ի կամ ավելի բարձր x86 մոդելի համար: 

Ընտրությունը կատարելուց հետո կբեռնվի Arch-ի LiveCD տարբերակը, որի միջոցով էլ հենց կատարվելու է տեղադրումը: Այս գրառման մեջ կպատմվի միայն այն դեպքը, երբ Arch-ը տեղադրվում է համատեղ ~~Windows~~-ի կամ այլ ՕՀ-ի հետ։ Առանց ~~Windows~~֊ի տեղադրելն ու օգտագործելն, իհարկե ավելի հեշտ է ու ճիշտ, սակայն կնկարագրեմ ընդհանուր դեպքում։ 

Այժմ պետք է բաժանել կոշտ սկավառակը(այսուհետ դիսկ) մասերի(partitions), ապա իմաստավորել ամեն մի մասը։ Մի երկու բառով այն մասին, թե ինչ մասեր են մեզ անհրաժեշտ։ Բաժանման տերբերակներ կարելի է նշել հազարներով, սակայն ես կնարագրեմ նրանք, որրնք ինքս եմ օգտագործում։ 

Այսուհետ ես ենթադրելու եմ, որ դիսկն ունի օրինակ 250G տարողունակություն և կոչվում է sda (այսինքն հասանելի է /dev/sda հասցեով): Դիսկի անունը պարզելու համար անցեք /dev/ պանակ և ուսումնասիրեք պարունակությունը։ Կամ տերմինալում հավաքեք _fdisk -l /dev/sd?_:

Ես պատրաստվում եմ հատկացնել 104G կարգի Windows-ի համար, որը, սակայն, բաղկացած կլինի միայն C: բաժնից։ Մեզ հարկավոր է նաև մոտ 512M ծավալով մաս boot-ի համար, 2G կամ 4G swap-ի համար (կամ ավելի քիչ ֊ կախված է օպերատիվ հիշողությունից) ~50G ծավալով մաս / (root)-ի համար և, վերջապես, մնացած ծավալով մի մաս՝ /home-ի համար։ Այժմ նկարագրենք մասերի բաժանումը։ Բաժանման ընդացքում կատարված փոփոխությունները չեն ազդում իրական դիսկի վրա, քանի դեռ դուք ինքներդ չեք հաստատի այդ փոփոխությունները։ Որպես բաժանման գործիք կօգտագործենք *fdisk*-ը: Սպասվող արդյունքը հետևյալն է.
```
/dev/sda1 *         2048 209717247 104857600   7 HPFS/NTFS/exFAT
/dev/sda2      209717248 210741247    512000  83 Linux
/dev/sda3      210741248 214935551   2097152  82 Linux swap / Solaris
/dev/sda4      214935552 488397167 136730808   5 Extended
/dev/sda5      214937600 319795199  52428800  83 Linux
/dev/sda6      319797248 488397167  84299960  83 Linux
```

Նախ տերմինալում հավաքում ենք **fidsk /dev/sda** աշխատանքը սկսելու համար: Ապա ջնջում ենք բոլոր գոյություն ունեցող բաշանումները, եթե, իհարկե, այդպիսիք կան: Դրա համար  մուտքագրում ենք **d** (delete), ընտրում ենք համարը (հերթով բոլորը) և հաստատում ենք: 

Երբ բոլոր մասերը ջնջված են, սկսում ենք ստեղծել նորերը: Որպեսզի ավելի հեշտ լինի մասերը հիշել, խորհուրդ է տրվում թղթի վրա գրանցել ստեղծված մասի համարը, չափն ու իմաստը: Առաջինը ստեղծում ենք ~~Windows~~-ի մասը: Դրա համար մուտքագրում ենք **n**, ընտրում ենք տիպը -   **p** (primary),  ապա մասի համարը -  **1** (sda1),  որպես First Sector թողնում ենք լռությամբ ընտրված արժեքը և հաստատում, իսկ որպես Last Sector գրում ենք ոչ թե ցանկալի սեկտորի համարը, այլ քանի M (mb) կամ G (gb) ենք ոզում հատկացնել, մեր դեպքում գրում ենք - **+104G** և հաստատում ենք: Հիմա հարկավոր է նշել մասը, որպես NTFS, ապա նշել որպես բեռնվող (bootable): Դրա համար մուտքագրում ենք **t**, ընտրում ենք **1**, ապա մուտքագրում ենք **7** (HPFS/NTFS/exFAT) և հաստատում ենք: Այնուհետև մուտքագրում ենք **a**, նշումենք **1** և հաստատում ենք: ~~Windows~~-ի համար նախատեսված մասը պատրաստ է: 

Ընթացքին հետևելու համար հավաքում ենք **p** և ստուգում ենք արդյունքը:Այս պահին արդյունքը պետք է լինի հետևյալը (մոտավորապես).
```
/dev/sda1 *         2048 209717247 104857600   7 HPFS/NTFS/exFAT
``` 

_*-ը_ նշանակում է, որ մասը բեռնվող է, իսկ տիպը նշված է _HPFS/NTFS/exFAT_, ինչպես որ նախատեսել էինք: Եթե սխալ արդյունք եք ստացել, փորձեք սկսել նորից: 

Հաջորդը (երկրորդը) կսեղծենք boot֊ի համար նախատեսված մասը, որին կհատկացնենք 512M: Գրում ենք **n**, ընտրում ենք (թողնում ենք լռությամբ) **p**, մասի համարը մուտքագրում ենք **2**, սկզբի սեկտորը թողնում ենք լռությամբ, իսկ վերջինը նշելու համար մուտքագրում ենք **+512M** և հաստատում ենք։ Արդյունքը, ինչպես երևի ենթադրեցիք, պետք է լինի հետևյալը․
```
/dev/sda1 *         2048 209717247 104857600   7 HPFS/NTFS/exFAT
/dev/sda2      209717248 210741247    512000  83 Linux
```

Երրորդը ստեղծում ենք swap մասը։ Կատարում ենք հետևյալ քայլերը․ **n**, **p** (primary), **3** (partition number), որպես first sector թողնում ենք լռությամբ արժեքը, իսկ վերջինի որոշման համար գրում ենք **+2G** (կամ այլ չափ ձեր հայեցողությամբ)։ Այժմ հարկավոր է փոխել մասի տիպը։ Դրա համար հավաքում ենք **t**, ընտրում ենք **3**, տիպը նշում ենք **82**:Ապա, **p** մուտքագրելով, ստուգում ենք արդյունքը․
```
/dev/sda1 *         2048 209717247 104857600   7 HPFS/NTFS/exFAT
/dev/sda2      209717248 210741247    512000  83 Linux
/dev/sda3      210741248 214935551   2097152  82 Linux swap / Solaris
```

Քանի որ, ըստ սահմանափակման, հնարավոր է ստեղծել միայն 4 primary մաս, մենք կստեղծենք մեծ վիրտուալ կոնտեյներ, որում կտեղադրենք մնացած մասերը, որոնք արդեն կլինեն logical: 

Դրա համար գրում ենք **n**, ընտրում ենք **e** (extended), համարը նշում ենք **4** (կընտրվի ավտոմատ), իսկ առաջին և վերջին սեկտորների համարները թողնում ենք լռությամբ արժեքները (տվյալ սեկտորից մինչև վերջ): 

Հիմա ստեղծենք մնացած երկու մասերն, արդեն որպես logical մաս։ Գրում ենք **n**, համարն (**5**) ու տիպը (**logical**) կընտրվի ավտոմատ, լռությամբ արժեքով հաստատում ենք first sector դաշտը, իսկ վերջում նշում ենք **+50G** և հաստատում ենք։ Այս մասը նախատեսված է որպես արմատային մաս օգտագործելու համար։ Հենց այստեղ են գտնվելու ծրագրերը, հիմանակն համակարգը և համակարգային բոլոր ֆայլերը։ 

Իսկ վերջին (վեցերորդ) մասը ստեղծեք ինքներդ, հաստատելով որպես վերջին սեկտոր լռությամբ արժեքը (մինչև դիսկի վերջ)։ Ստուգենք ստացված արդյունքը **p** (print) հրամանով։ Այն պետք է ունենա մոտավորապես հետևյալ տեսքը․
```
/dev/sda1 *         2048 209717247 104857600   7 HPFS/NTFS/exFAT
/dev/sda2      209717248 210741247    512000  83 Linux
/dev/sda3      210741248 214935551   2097152  82 Linux swap / Solaris
/dev/sda4      214935552 488397167 136730808   5 Extended
/dev/sda5      214937600 319795199  52428800  83 Linux
/dev/sda6      319797248 488397167  84299960  83 Linux
```

Եթե կան չհամընկնումներ (բացի չափի հետ կապված որոշ տարբերություններից), կարող եք բոլորը ջնջել և սկսել նորից։ 

Այժմ, մուտքագրելով **w** (write) հաստատում ենք կատարած փոփոխությունները, որից հետո դիսկի ամբողջ պարունակությունը կջնջվի, և դիսկը կստանա վերոնշյալ բաժանումը։ 

Հիմա, առաջնահերթ, դնում ենք ~~Windows~~-ը։ Դրա համար հավաքում ենք **reboot**, տեղադրում ենք ~~Windows~~-ի usb-ն կամ սկավառակը և բեռնում ենք տեղադրող ծրագիրը։ Install անելու համար բավական է կատարել հետևյալը․ ֆորմատավորում ենք այն մասը, որը հատկացրել եինք ~~Windows`~~-ի համար (104G), ակտիվացնում ենք այն (սեղմում ենք մկնիկով) և հաստատում ենք **Install** կոճակով։ Բարեհաջող ավարտից հետո նորից տեղադրում ենք Arch Linux-ի սկավառակը (կամ USB-ն) և նույն կերպ մուտք ենք գործում Live CD, որպեսզի, վերջապես, սկսենք Արչի installation-ը։ 

Նախ և առաջ հարկավոր է ֆորմատավորել մասերը․ 1-ը ձեռք չենք տալիս, 2-ը ext2, 3-ը swap, 5-ը ext4 (root) և 6-ը ext4: 

սկսենք swap-ից․
```bash
mkswap -L swap /dev/sda3
swapon /dev/sda3
```
Առաջին հրահանգը ֆորմատավորում է, իսկ երկրորդը միացնում swap մասը։

Մնացածը ֆորմատավորելու համար հերթով մուտքագրենք հետևյալ հրահանգները․

```bash
mkfs.ext2 -L boot /dev/sda2
mkfs.ext4 -L arch-root /dev/sda5
mkfs.ext3 -L home /dev/sda6
```

Հիմա հարկավոր է կցել մասերը (որոնք արդեն առանձին վիրտուալ դիսկեր են) մեր համակարգին, մասնավորամես կցել /dev/sda5 մասը /mnt պանակին, իսկ /dev/sda2 և /dev/sda6 մասերը համապատասխանաբար /mnt/boot և /mnt/home պանակներին․
```bash
mount /dev/sda5 /mnt
mkdir /mnt/boot
mkdir /mnt/home
mount /dev/sda2 /mnt/boot
mount /dev/sda6 /mnt/home
```

Հաջողված ավարտից հետո, անցնում ենք բուն Արչի համակարգի տեղադրմամբ։ Դրա համար մեզ անհրաժեշտ է միացված ցանց։ 
Ես կենթադրեմ, որ դուք ունեք միացված լարային կամ անլար ցանց, որում կարգավորված է հասցեների ավտոմատ բաշխման սերվերը (dhcp server), այլապես, ստիպված կլինեք ձեռքով կարգավորել ստատիկ IP հասցե։ Թե ինչպես դա անել, կարող եք ընթերցել Arch Wiki պորտալում։ Ստուգենք կապի առկայությունը և անցնենք առաջ․ 
```bash
ping -c 4 8.8.8.8

```

Քանի որ համակարգը բեռնվում է ցանցից, կարող է կարիք առաջանալ ընտրել բեռնման ավելի մոտ սերվեր, բայց ընդհանուր առմամբ, դա այնքան էլ էական չէ։ Ցանկության դեպքում հարկավոր է խմբագրել _/etc/pacman.d/mirrorlist_ ֆայլը և ցանկալի սերվերը ապամեկնաբանված (առանց մեկնաբանության # նշանի) տանել ֆայլի սկիզբ, պահել և փակել ֆայլը։ Այս քայլը, թերևս, կարելի է բաց թողնել։ 

Համակարգի բեռնումը սկսում ենք հետևյալ հրահանգով
```bash
pacstrap /mnt base base-devel
```
Հաստատում ենք բեռնումը **y**֊ով և սպասում ենք բեռնման ավարտին։

Ավարտից հետո անցնում ենք fstab սկրիպտի գեներացմանը, որը մեր փոխարեն ամեն անգամ կկցի մասերը(partitions) համակարգին։ Դա արվում է այսպես․
```bash
genfstab -U -p /mnt >> /mnt/etc/fstab
```

Հիմա անցում ենք կատարում արդեն տեղադրված Arch Linux-ին հետևյալ կերպ․
```bash
arch-chroot /mnt
```
Ստանում ենք պատրաստ shell (sh-x.x# ):

Հիմա բեռնում ենք ՕՀ֊ի բեռնիչներից որևէ մեկը (այս օրինակում grub-bios).
```bash
pacman -S grub-bios
```
Հաստատում ենք y-ով։ Գրանցում ենք համակարգչի անունը (օրինակ my-archlinux-comp).
```bash
echo 'my-archlinux-comp' > /etc/hostname
```
Կարգավորում ենք ժամային գոտին․
```bash
ln -s /usr/share/zoneinfo/Asia/Yerevan /etc/localtime
```

Այժմ, օգտագործելով nano խմբագրիչը կարգավորում ենք լեզվային տվյալները․
```bash
nano /etc/locale.gen
```
Ապամեկնաբանում ենք (հեռացնում ենք դիմացի վանդականիշը) միայն այն գրառումները, որոնք ոզում ենք առկա լինեն համակարգում։ Այս օրինակում դրանք են հայերեն, ռուսերեն և անգլերեն լեզուները։ Այսինքն ապամեկնաբանում ենք հետևյալ գրառումները․
```bash
hy_AM UTF-8  
hy_AM.ARMSCII-8 ARMSCII-8 
en_US.UTF-8 UTF-8  
en_US ISO-8859-1 
ru_RU.KOI8-R KOI8-R  
ru_RU.UTF-8 UTF-8  
ru_RU ISO-8859-5  
ru_UA.UTF-8 UTF-8  
ru_UA KOI8-U  

```
Պահպանում ենք փոփոխությունները (Ctrl O, Enter) և փակում ենք ֆայլը (Ctrl x): Հաջորդիվ ընտրում ենք անգլերենը, որպես հիմնական լեզու և գեներացնում ենք լեզվական կարգավորումները․
```bash
echo 'LANG="en_US.UTF-8"' > /etc/locale.conf
locale-gen
```

Գեներացնում ենք միջուկի պատկերը․
```bash
mkinitcpio -p linux
```
Անցնենք ՕՀ բեռնող ծրագրի կարգավորմանը։ Քանի որ, մենք ունենք երկու օպերացիոն համակարգ, մեզ անհրաժեշտ է ևս մի գործիք (os-prober), որը թույլ կտա ավտոմատ հայտնաբերել բոլոր ՕՀերը համակարգում.
```bash
pacman -S os-prober
os-prober
```

Կարգավորենք grub բեռնիչը և տեղադրենք /dev/sda դիսկի վրա․
```bash
grub-mkconfig -o /boot/grub/grub.cfg 
grub-install /dev/sda
```

Կարգավորենք համակարգի root օգտագործողի գաղտնաբառը (մուտքագրելու ընթացքում էկրանին սիմվոլներ չեն արտածվում)․
```bash
passwd
```

Հաջորդ քայլն է դուրս գալ համակարգից և անջատել կցված մասերը․
```bash
exit
umount /mnt/boot
umount /mnt/home
umount /mnt
swapoff /dev/sda3
```

Վերջ․ Հանեք սկավառակը համակարգչից և կատարեք restart.
```bash
reboot
```

Միացված համակարգը հենց Arch Linux-ն է, որը դեռևս չունի գրաֆիկական ինտերֆեյս։ Հաջորդ գրառումը կլինի XServer-ի և Xfce միջավայրի տեղադրման մասին։ Ի դեպ, Առչը այն եզակի համակարգերից է, որն ունի լիարժեք և ինֆորմատիվ թղթաբանություն, որը հասանելի է [այս](https://wiki.archlinux.org/) հասցեով։ 

